# Dashboard Components Contract

**Feature**: 002-web-dashboard
**Date**: 2025-12-17

## Overview

Streamlit ëŒ€ì‹œë³´ë“œì˜ ê° ì»´í¬ë„ŒíŠ¸ ì¸í„°í˜ì´ìŠ¤ ì •ì˜.

## Components

### 1. EmergencyPanel

ë¹„ìƒì •ì§€ ì œì–´ íŒ¨ë„.

```python
def render_emergency_panel(
    is_active: bool,
    on_activate: Callable[[], None],
    on_deactivate: Callable[[], None]
) -> None:
    """
    ë¹„ìƒì •ì§€ ì œì–´ íŒ¨ë„ ë Œë”ë§.

    Args:
        is_active: í˜„ì¬ ë¹„ìƒì •ì§€ í™œì„±í™” ìƒíƒœ
        on_activate: ë¹„ìƒì •ì§€ ë²„íŠ¼ í´ë¦­ ì½œë°±
        on_deactivate: ì¬ê°œ ë²„íŠ¼ í´ë¦­ ì½œë°±

    UI Elements:
        - ğŸ”´ ë¹„ìƒì •ì§€ ë²„íŠ¼ (is_active=Falseì¼ ë•Œ í™œì„±í™”)
        - ğŸŸ¢ ì‹œìŠ¤í…œ ì¬ê°œ ë²„íŠ¼ (is_active=Trueì¼ ë•Œ í™œì„±í™”)
        - ìƒíƒœ í‘œì‹œ: "ğŸŸ¢ ìë™ê±°ë˜ í™œì„±í™”" / "ğŸ”´ ë¹„ìƒì •ì§€ ìƒíƒœ"
    """
    pass
```

**Acceptance Criteria**:
- ë¹„ìƒì •ì§€ ë²„íŠ¼ í´ë¦­ ì‹œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
- ìƒíƒœ ë³€ê²½ í›„ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
- ë²„íŠ¼ ìƒíƒœê°€ í˜„ì¬ ìƒíƒœì™€ ì¼ì¹˜

---

### 2. PositionCard

í¬ì§€ì…˜ í˜„í™© ì¹´ë“œ.

```python
def render_position_card(
    position: Optional[dict]
) -> None:
    """
    í˜„ì¬ í¬ì§€ì…˜ ì •ë³´ í‘œì‹œ.

    Args:
        position: í¬ì§€ì…˜ ë°ì´í„° ë˜ëŠ” None (í¬ì§€ì…˜ ì—†ìŒ)
            {
                "upbit_quantity": Decimal,
                "upbit_entry_price": Decimal,
                "upbit_current_value": Decimal,
                "binance_quantity": Decimal,
                "binance_entry_price": Decimal,
                "entry_kimp": Decimal
            }

    UI Elements:
        - ì—…ë¹„íŠ¸ í¬ì§€ì…˜: ìˆ˜ëŸ‰, í‰ê°€ì•¡
        - ë°”ì´ë‚¸ìŠ¤ í¬ì§€ì…˜: ìˆ˜ëŸ‰, ì§„ì…ê°€
        - ì§„ì… ê¹€í”„ìœ¨
        - í¬ì§€ì…˜ ì—†ìœ¼ë©´ "í¬ì§€ì…˜ ì—†ìŒ" í‘œì‹œ
    """
    pass
```

---

### 3. KimpChart

ê¹€í”„ìœ¨ ì°¨íŠ¸.

```python
def render_kimp_chart(
    data: pd.DataFrame,
    current_kimp: float,
    entry_kimp: Optional[float] = None
) -> None:
    """
    ê¹€í”„ìœ¨ ì¶”ì´ ì°¨íŠ¸ ë Œë”ë§.

    Args:
        data: DataFrame with columns ['timestamp', 'kimp_rate']
        current_kimp: í˜„ì¬ ê¹€í”„ìœ¨ (%)
        entry_kimp: ì§„ì… ê¹€í”„ìœ¨ (í¬ì§€ì…˜ ìˆì„ ë•Œ)

    UI Elements:
        - 1ì‹œê°„ ë¼ì¸ ì°¨íŠ¸ (Plotly)
        - í˜„ì¬ ê¹€í”„ìœ¨ í‘œì‹œ: "í˜„ì¬: 3.24%"
        - ì§„ì… ê¹€í”„ìœ¨ ìˆ˜í‰ì„  (í¬ì§€ì…˜ ìˆì„ ë•Œ)
        - ì—…ë¹„íŠ¸/ë°”ì´ë‚¸ìŠ¤Ã—í™˜ìœ¨ ê°€ê²© í‘œì‹œ
    """
    pass
```

---

### 4. PnLCard

ì†ìµ í˜„í™© ì¹´ë“œ.

```python
def render_pnl_card(
    pnl: Optional[dict]
) -> None:
    """
    ì†ìµ í˜„í™© í‘œì‹œ.

    Args:
        pnl: ì†ìµ ë°ì´í„° ë˜ëŠ” None
            {
                "kimp_profit": Decimal,  # ê¹€í”„ ì°¨ìµ (%)
                "funding_profit": Decimal,  # í€ë”©ë¹„ (%)
                "fee": Decimal,  # ìˆ˜ìˆ˜ë£Œ (%)
                "net_profit": Decimal,  # ìˆœì´ìµ (%)
                "daily_pnl_krw": Decimal,  # ê¸ˆì¼ ì†ìµ (KRW)
                "total_pnl_krw": Decimal  # ëˆ„ì  ì†ìµ (KRW)
            }

    UI Elements:
        - ê¹€í”„ ì°¨ìµ, í€ë”©ë¹„, ìˆ˜ìˆ˜ë£Œ ê°œë³„ í‘œì‹œ
        - ìˆœì´ìµ ê°•ì¡° (+ ë…¹ìƒ‰, - ë¹¨ê°„ìƒ‰)
        - ê¸ˆì¼/ëˆ„ì  KRW ì†ìµ
    """
    pass
```

---

### 5. SystemStatus

ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ.

```python
def render_system_status(
    status: dict
) -> None:
    """
    ì‹œìŠ¤í…œ ì—°ê²° ìƒíƒœ í‘œì‹œ.

    Args:
        status: {
            "upbit": {"status": "ok", "latency_ms": 23},
            "binance": {"status": "ok", "latency_ms": 45},
            "fx": {"status": "ok"},
            "db": {"status": "ok"},
            "error_count_1h": 0
        }

    UI Elements:
        - ê° ì„œë¹„ìŠ¤ ìƒíƒœ: ğŸŸ¢ ì •ìƒ / ğŸ”´ ì—ëŸ¬
        - ì‘ë‹µ ì‹œê°„ (ms)
        - ìµœê·¼ 1ì‹œê°„ ì—ëŸ¬ ê±´ìˆ˜
    """
    pass
```

---

### 6. TradeHistory

ê±°ë˜ ì´ë ¥ í…Œì´ë¸”.

```python
def render_trade_history(
    trades: List[dict]
) -> None:
    """
    ìµœê·¼ ê±°ë˜ ì´ë ¥ í…Œì´ë¸” ë Œë”ë§.

    Args:
        trades: ê±°ë˜ ëª©ë¡ (ìµœëŒ€ 10ê±´)
            [{
                "timestamp": datetime,
                "exchange": str,  # "upbit" / "binance"
                "side": str,  # "buy" / "sell" / "short" / "cover"
                "quantity": Decimal,
                "price": Decimal
            }]

    UI Elements:
        - í…Œì´ë¸”: ì‹œê°„, ê±°ë˜ì†Œ, ì•¡ì…˜, ìˆ˜ëŸ‰, ê°€ê²©
        - ì‹œê°„ ì—­ìˆœ ì •ë ¬
        - ê±°ë˜ ì—†ìœ¼ë©´ "ê±°ë˜ ì´ë ¥ ì—†ìŒ" í‘œì‹œ
    """
    pass
```

## Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ ë¹„ìƒ ì œì–´ íŒ¨ë„ (EmergencyPanel)                          â”‚
â”‚  [ë¹„ìƒì •ì§€] [ì¬ê°œ]  ìƒíƒœ: ğŸŸ¢ ìë™ê±°ë˜ í™œì„±í™”                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š í¬ì§€ì…˜ í˜„í™©          â”‚  â”‚  ğŸ“ˆ ê¹€í”„ìœ¨ í˜„í™©                  â”‚
â”‚  (PositionCard)         â”‚  â”‚  (KimpChart)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’° ì†ìµ í˜„í™©            â”‚  â”‚  âš¡ ì‹œìŠ¤í…œ ìƒíƒœ                  â”‚
â”‚  (PnLCard)              â”‚  â”‚  (SystemStatus)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ ìµœê·¼ ê±°ë˜ ì´ë ¥ (TradeHistory)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Test Scenarios

```python
# tests/unit/test_dashboard_components.py

def test_emergency_panel_shows_stop_button_when_active():
    """ì •ìƒ ìƒíƒœì—ì„œ ë¹„ìƒì •ì§€ ë²„íŠ¼ í‘œì‹œ"""
    pass

def test_position_card_shows_empty_when_no_position():
    """í¬ì§€ì…˜ ì—†ì„ ë•Œ 'í¬ì§€ì…˜ ì—†ìŒ' í‘œì‹œ"""
    pass

def test_kimp_chart_renders_with_data():
    """ê¹€í”„ ë°ì´í„°ë¡œ ì°¨íŠ¸ ë Œë”ë§"""
    pass

def test_pnl_card_shows_green_for_profit():
    """ì´ìµì¼ ë•Œ ë…¹ìƒ‰ í‘œì‹œ"""
    pass

def test_system_status_shows_red_for_error():
    """ì—ëŸ¬ ì‹œ ë¹¨ê°„ìƒ‰ í‘œì‹œ"""
    pass

def test_trade_history_limits_to_10():
    """ê±°ë˜ ì´ë ¥ ìµœëŒ€ 10ê±´ í‘œì‹œ"""
    pass
```
